\section{Estimation command and subcommand syntax\label{sec:estimation-syntax}}

\subsection{Estimation methods}

\defCom{Estimation} 

\defSub{minimiser} {The label of the minimiser to use, if doing a point estimate}
\defType{String}
\defDefault{None}
\defValue{A valid label from \command{minimiser}}

\defSub{MCMC} {The label of the MCMC to use, of doing an MCMC}
\defType{String}
\defDefault{None}
\defValue{A valid label from \command{MCMC}}

\defSub{profile} {The labels of the profiles to use, if doing a profile}
\defType{String}
\defDefault{None}
\defValue{A valid label from \command{MPD}}

\defSub{random\_seed}{Defines the random number generator seed}
\defArg{value}{The random number generator seed value}
\defType{Integer}
\defDefault{None}
\defValue{An integer between 0 and 10000 inclusive}

\subsection{Point estimation}

Two methods of minimising when doing a point estimate are, 
 
\begin{itemize}
	\item Numerical differences minimiser
  \item Differential evolution minimiser
\end{itemize}

Note that point estimates are required for

\begin{itemize}
  \item MPDs
  \item To generate the starting values and covariance matrix for an MCMC
  \item To calculate the point estimates for profiles
\end{itemize}
  
Each type of minimiser requires a set of subcommands and arguments specific to that minimiser. Different minimisers can be called for different model runs or for different run modes (i.e., MCMC, MPDs, or profiles).

\defComLab{Minimiser}{Define the an minimiser estimator with label}

\defSub{type} {Define the type of minimiser}
\defType{String}
\defDefault{numerical\_differences}
\defValue{A valid type of minimiser, either numerical\_differences or DE\_solver}

\subsubsection[Numerical differences minimiser]{\commandlabsubarg{minimiser}{type}{numerical\_differences}} 

\defSub{max\_iterations} {Define the maximum number of iterations for the minimiser}
\defType{Integer}
\defDefault{1000}
\defValue{A positive integer}

\defSub{max\_evaluations} {Define the maximum number of evaluations for the minimiser}
\defType{Integer}
\defDefault{4000}
\defValue{A positive integer}

\defSub{step\_size} {Define the step-size for the minimiser}
\defType{Constant}
\defDefault{1e-6}
\defValue{A positive real number}

\defSub{gradient\_tolerance} {Define the gradient tolerance for the minimiser}
\defType{Constant}
\defDefault{0.0002}
\defValue{A positive real number}

\subsubsection[Differential evolution minimiser]{\commandlabsubarg{minimiser}{type}{DE\_solver}} 

\defSub{max\_iterations} {Define the maximum number of iterations for the minimiser}
\defType{Integer}
\defDefault{1000}
\defValue{A positive integer}

\defSub{max\_evaluations} {Define the maximum number of evaluations for the minimiser}
\defType{Integer}
\defDefault{4000}
\defValue{A positive integer}

\defSub{step\_size} {Define the step-size for the minimiser}
\defType{Constant}
\defDefault{1e-6}
\defValue{A positive real number}

\defSub{gradient\_tolerance} {Define the gradient tolerance for the minimiser}
\defType{Constant}
\defDefault{0.0002}
\defValue{A positive real number}

\subsection{Monte Carlo Markov Chain (MCMC)}

Only one method of carrying out MCMCs is available, Monte Carlo Markov Chain using Metropolis-Hastings

\defComLab{MCMC}{Define the MCMC estimation arguments}

\defSub{type} {Define the method of MCMC}
\defType{String}
\defDefault{Metropolis\_Hastings}
\defValue{A valid type of MCMC, currently only Metropolis-Hastings is available}

\subsubsection[Metropolis-Hastings]{\commandsubarg{MCMC}{type}{Metropolis\_Hastings}} 

\defSub{start} {Covariance multiplier for the starting point of the Markov chain}
\defType{Constant}
\defDefault{0}
\defValue{If 0, defines the starting point of the chain as the point estimate.	If >0, defines the starting point as randomly generated, with covariance matrix equal to the approximate covariance (inverse Hessian) times the value of this start parameter}

\defSub{length} {Length of the Markov chain}
\defType{Integer}
\defDefault{None}
\defValue{Defines the length of the Markov chain (as a number of iterations)}

\defSub{keep} {Spacing between recorded values in the chain}
\defType{Integer}
\defDefault{1}
\defValue{Defines the spacing between recorded values in the chain. Samples from the posterior are written to file only if their sample number is evenly divisible by \argument{keep}}

\defSub{max\_correlation} {Maximum absolute correlation in the covariance matrix of the proposal distribution}
\defType{Constant}
\defDefault{0.8}
\defValue{Defines the maximum correlation in the covariance matrix of the proposal distribution. Correlations greater than max\_correlation are decreased to max\_correlation, and those less than -max\_correlation are increased to -max\_correlation }

\defSub{correlation\_adjustment\_method} {Method for adjusting small variances in the covariance proposal matrix}
\defType{String}
\defDefault{correlation}
\defValue{Defines the method (either correlation or covariance) for the adjusting small variances in the covariance matrix of the proposal distribution}

\defSub{correlation\_adjustment\_diff} {Minimum non-zero variance times the range of the bounds in the covariance matrix of the proposal distribution}
\defType{Constant}
\defDefault{0.0001}
\defValue{Defines the minimum non-zero variance times the difference in the bounds of each parameter in the covariance matrix of the proposal distribution}

\defSub{step\_size} {Initial step-size (as a multiplier of the approximate covariance matrix)}
\defType{Constant}
\defDefault{$2.4d^{-0.5}$ where $d$ is the number of free parameters}
\defValue{The covariance of the proposal distribution is the approximate covariance (inverse Hessian) times this step-size parameter}

\defSub{proposal\_distribution} {The shape of the proposal distribution (either \textit{t} or normal)}
\defType{String}
\defDefault{t}
\defValue{Either \argument{t} or \argument{normal}. Defines whether the proposal distribution should be multivariate t rather than multivariate normal}

\defSub{df} {Degrees of freedom of the multivariate t proposal distribution}
\defType{Integer}
\defDefault{4}
\defValue{Defines the degrees of freedom of the multivariate t proposal distribution}

\subsection{Profiles}

Only one method of carrying out profiles is available,

\defComLab{profile}{Define the profile parameters, minimiser, and arguments}

\defSub{parameter} {Name of the parameter to be profiled}
\defType{String}
\defDefault{None}
\defValue{Defines the name of the parameter to be profiled}

\defSub{minimiser} {The label of the minimiser to use}
\defType{String}
\defDefault{None}
\defValue{A valid label from \command{minimiser}}

\defSub{n} {Number of values at which to profile the parameter}
\defType{Integer}
\defDefault{10}
\defValue{Defines the number of values at which to profile the parameter}

\defSub{lower\_bound} {lower bound on parameter}
\defType{Integer}
\defDefault{None}
\defValue{Defines the lower bound on the range of the parameter to profile}

\defSub{upper\_bound} {Upper bound on parameter}
\defType{Integer}
\defDefault{None}
\defValue{Defines the upper bound on the range of the parameter to profile}

\subsection{Defining the free parameters and priors}

\defComArg{estimate}{parameter\_name}{Estimate a free parameter}
\defArg{parameter\_name}{The \SPM\ name of the parameter to estimate}
\defType{string}
\defDefault{None}
\defValue{A valid \SPM\ parameter name}

\defSub{same}{Names of the other parameters which are constrained to have the same value}
\defType{String Vector}
\defDefault{None}
\defValue{Defines the names of all the other parameters which are constrained to have the same value as this parameter}

\defSub{phase}{Phase at which this parameter should be estimated, in point estimation}
\defType{Integer}
\defDefault{1}
\defValue{Defines the phase at which this parameter should be freed}

\defSub{lower\_bounds}{Lower bounds on this parameter}
\defType{Constant vector, of length equal to the parameter length}
\defDefault{None}
\defValue{Defines the lower bound(s) on this parameter}

\defSub{upper\_bound}{Upper bound on this parameter}
\defType{Constant vector, of length equal to the parameter length}
\defDefault{None}
\defValue{Defines the upper bound(s) on this parameter}

\defSub{MCMC\_fixed}{Should this parameter be fixed during MCMC?}
\defType{Switch}
\defDefault{False}
\defValue{Define this parameter as fixed during MCMC (i.e., considered a constant for the MCMC)}

\defSub{prior}{Defines the prior for this parameter}
\defType{String}
\defDefault{No default}
\defValue{Defines the type of prior on this parameter, and includes uniform, uniform-log, normal, normal-by-stdev, lognormal, Beta}

Different priors require different subcommands.

\subsubsection[Uniform prior]{\commandlabsubarg{estimate}{prior}{uniform}} 

The command \commandlabsubarg{estimate}{prior}{uniform} has no other subcommands.

\subsubsection[Uniform-log prior]{\commandlabsubarg{estimate}{prior}{uniform\_log}} 

The command \commandlabsubarg{estimate}{prior}{uniform\_log} has no other subcommands.

\subsubsection[Normal prior]{\commandlabsubarg{estimate}{prior}{normal}} 

\defSub{mu}{Defines the mean $\mu$ of the normal prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the mean of the normal prior}

\defSub{cv}{Defines the c.v. $c$ of the normal prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the c.v. of the normal prior}

\subsubsection[Normal-by-stdev prior]{\commandlabsubarg{estimate}{prior}{normal\_by\_stdev}} 

\defSub{mu}{Defines the mean $\mu$ of the normal by standard deviation prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the mean of the normal by standard deviation prior}

\defSub{stdev}{Defines the standard deviation $\sigma$ of the normal by standard deviation prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the standard deviation of the normal by standard deviation prior}

\subsubsection[Lognormal prior]{\commandlabsubarg{estimate}{prior}{lognormal}} 

\defSub{mu}{Defines the mean $\mu$ of the lognormal prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the mean of the lognormal prior}

\defSub{cv}{Defines the c.v. $c$ of the lognormal prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the c.v. of the lognormal prior}

\subsubsection[Beta prior]{\commandlabsubarg{estimate}{prior}{beta}} 

\defSub{A}{The lower value of the range parameter $A$ of the Beta prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the lower value of the range parameter $A$ of the Beta prior}

\defSub{B}{The upper value of the range parameter $B$ of the Beta prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the upper value of the range parameter $B$ of the Beta prior}

\defSub{mu}{Defines the mean $\mu$ of the Beta prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the mean of the Beta prior}

\defSub{stdev}{Defines the standard deviation $\sigma$ of the Beta prior}
\defType{Constant}
\defDefault{No default}
\defValue{Defines the standard deviation of the Beta prior}

\subsection{Defining ageing error}

Three methods for including ageing error into estimation with observations are, 
 
\begin{itemize}
	\item None
	\item Normal
	\item Off-by-one
\end{itemize}

Each type of ageing error requires a set of subcommands and arguments specific to its type.

\defComLab{ageing\_error}{Define ageing error with \argument{label}}

\defSub{type} {The type of ageing error}
\defType{String}
\defDefault{None}
\defValue{Defines the type of ageing error to use, currently only normal is defined}

\subsubsection[No ageing error]{\commandlabsubarg{ageing\_error}{type}{none}} 

The \commandlabsubarg{ageing\_error}{type}{none} has no other subcommands.

\subsubsection[Normal ageing error]{\commandlabsubarg{ageing\_error}{type}{normal}} 

\defSub{c} {Parameter of the normal ageing error model}
\defType{Constant}
\defDefault{None}
\defValue{Define the c.v. of misclassification}

\subsubsection[Off-by-one ageing error]{\commandlabsubarg{ageing\_error}{type}{off\_by\_one}} 

\defSub{k} {The $k$ parameter of the off-by-one ageing error model}
\defType{Integer}
\defDefault{0}
\defValue{p1 and p2 define the proportions of misclassifications down and up by 1 year respectively. k defines the minimum age of fish which can be misclassified - fish under age k have no ageing error}

\defSub{p1} {The $p_1$ parameter of the off-by-one ageing error model}
\defType{Constant}
\defDefault{None}
\defValue{p1 and p2 define the proportions of misclassifications down and up by 1 year respectively. k defines the minimum age of fish which can be misclassified - fish under age k have no ageing error}

\defSub{p2} {The $p_2$ parameter of the off-by-one ageing error model}
\defType{Constant}
\defDefault{None}
\defValue{p1 and p2 define the proportions of misclassifications down and up by 1 year respectively. k defines the minimum age of fish which can be misclassified - fish under age k have no ageing error}

\subsection{Defining catchability constants}

\defComLab{q}{Define a catchability constant with \argument{label}}

\defSub{q} {Value of the q parameter}
\defType{Estimable}
\defDefault{None}
\defValue{Defines the value of the q parameter, a real positive number}

\subsection{Defining penalties}

To be written...