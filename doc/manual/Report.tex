\section{\I{The report section}\label{sec:report-section}}\index{Reports}\index{Reports section}

The report section specifies the printouts and other outputs from the model. \SPM\ does not, in general, produce any output unless requested by a valid report. 

Reports from \SPM\ can be defined to print the spatial structure, partition and states objects at a particular point in time, as well as layers, observation summaries, estimated parameters and objective function values. See below for a more extensive list.

Reports from \SPM\ all conform to a standard style\index{Reports ! standard style} (with one exception --- the \texttt{estimate\_values} report, see below). The standard style is that reports are prefixed with a user-defined label in square brackets (e.g., \texttt{[...]}), with the second line indicating the type of report, and the report ending with the line \texttt{*end}. For example,

\begin{verbatim} 
[My-report]
report.type: ...
...
*end
\end{verbatim}

This syntax should make it easier for external packages to be configured to read \SPM\ output. The \texttt{extract} functions in the \R\ \texttt{spm} package uses this information to identify and read \SPM\ output.

Notye that the \texttt{estimate\_values} report does not print either a header (e.g., \texttt{[...]} or \texttt{*end} at the end of the report. This is as the \texttt{estimate\_values} report is designed to provide a single line (or multi-line for more than one set) vector of the estimated parameter values, suitable for reading by \SPM\ (with the command\texttt{spm -i}. 

Reports, by default, are directed to standard out (see Section \ref{sec:redirecting-stdout}), but this default can be overwritten be specifying an output file (\commandlabsub{report}{file\_name}). Hence reports can be directed to separate files as required. Note that if an output file is defined, any data within it is deleted and replaced with the output from the report. To append data to an output file rather than replacing it, use the subcommand \commandlabsubarg{report}{overwrite}{false}.

Note that reports can be defined that are  not valid, for example printing the partition for a year and/or time-step that does not exist or reporting the covariance matrix when not estimating --- although  all reports must conform to syntax requirements. In these cases, \SPM\ does not generate output.

\subsection{\I{Printing the model spatial map}}\index{Reports ! Spatial map}

Print the spatial co-ordinates of each spatial cell (i.e., row and column labels of each spatial cell) of the spatial structure.

\subsection{\I{Printing the partition}}\index{Reports ! Partition}

Print the partition for a given year and time step. This prints out, for each row and column defined as a valid cell in the base layer (see Section \ref{sec:spatial-structure}), the numbers of individuals in each age class in the partition. Note that this report is evaluated at the end of the time-step in the given year.

\subsection{\I{Printing the partition at the end of an initialisation}}\index{Reports ! Initialisation}

Print the partition following an initialisation phase. This prints out, for each row and column defined as a valid cell in the base layer (see Section \ref{sec:spatial-structure}), the numbers of individuals in each age class in the partition at then end of that initialisation phase.

\subsection{\I{Printing a process summary}}\index{Reports ! Processes}

Print a summary of a process. Depending on the process, different summaries are produced. These typically detail the type of process, its parameters and other options, and any associated details.

\subsection{\I{Printing derived quantities}}\index{Reports ! Derived quantities}

Print out the description of the derived parameter, and the values of the derived quantity as recorded in the model state, for each year of the model. In addition, the report prints out the values of the derived quantity at the end of each initialisation phase.

\subsection{\I{Printing the estimated parameters}}\index{Reports ! Estimated parameters}

Print a summary of the estimated parameters, including the parameter name, lower and upper bounds, the label of the prior, and the its value.

\subsection{\I{Printing the estimated parameters in a vector format}}\index{Reports ! Estimated parameters}

Print the estimated parameter values out as a vector, in a format suitable for use with \texttt{spm -i}. The \texttt{estimate\_values} report prints two lines --- a line for the labels of the estimated parameters, and then a line of the values of the estimated parameters. For run modes that produce multi-line output (for example, MCMCs or profiles), only the first line contains the labels of the  estimated parameters. All subsequent lines are the values of the estimated parameters only (with each line representing a single set of parameter values). 

Note that unlike other reports, the \texttt{estimate\_values} report does not print either a header (e.g., \texttt{[...]} or \texttt{*end} at the end. 

\subsection{\I{Printing the objective function}}\index{Reports ! Objective function}

Print the total objective function value, and the value of all observations, the values of all priors, and the value of any penalties that have been incurred in the model. Note that if an individual model run does not incur a penalty, then the penalty will not be reported.

\subsection{\I{Printing the covariance matrix}}\index{Reports ! Covariance Matrix}\index{Reports ! Hessian}

Print the Hessian and covariance matrices if estimating and if the covariance has been requested by\commandlabsubarg{minimiser}{covariance}{true}.

\subsection{\I{Printing observations, fits, and residuals}}\index{Reports ! Observations}

Prints out the area (from the observation categorical layer), observed values (as supplied in the \config), expected values as calculated by the model, residuals (observed $-$ expected), the error value (as modified by any additional process error), and the contribution to the total objective function of that individual point in the observation. 

Note that constants in likelihoods are often ignored in the objective function score of individual points. Hence, the total score from an observation equals the contribution of the objective function scores from each individual point plus a constant term (if applicable). In likelihoods without a constant term, then the total score from an observation will equal the contribution of the objective function scores from each individual point.

If simulating, then the contribution to the objective function of each observation is reported as zero. 

\subsection{\I{Printing simulated observations}}\index{Reports ! Simulated observations}

Prints out a complete observation definition in a form suitable for use in a \SPM\ \config, reproducing the command and subcommands from the \config, but with the observations replaced with simulated values.

\subsection{\I{Printing the ageing error misclassification matrix}}\index{Reports ! Ageing error misclassification matrix}\label{sec:ageingerrorreport}

Prints out the ageing error misclassification matrix.

\subsection{\I{Printing layers}}\index{Reports ! Layers}

Prints the values in the layer (including user supplied layers, abundance and biomass layers, and meta-layers) for a given year and at the end of a given time step. 

\subsection{\I{Printing a derived view via a categorical layer}}\index{Reports ! Derived view}

Prints a summary of the partition, as seen via a categorical layer. Here, values within the spatial cells of a partition are aggregated within the regions defined by the categorical layer for a given age range and given model categories.

\subsection{\I{Printing selectivities}}\index{Reports ! Selectivities}

Prints the values of a selectivity for each age in the partition, for a given year and at then end of a given time step.

\subsection{\I{Printing the random number seed}}\index{Reports ! Random number seed}

Prints the random number seed used by \SPM\ to generate the random number sequence. Future runs made with the same random number seed and the same model will produce identical outputs.


\TOUNDO
 This section needs to be removed and replaced with the section below where it includes age, size and weight checks

\subsection{\I{Verifying the size-weight relationship}\label{sec:report-weight-at-size}}\index{Reports ! Size-at-age}

Prints a summary of the size-weight relationship used by \SPM\ for each category by printing the mean weight for a list of sizes. Useful for verifying that the choice of parameters (and their magnitude) are sensible choices.

\TOUNDOend

\TODO

\subsection{\I{Verifying the size-at-age and size-weight relationships}\label{sec:report-age-size-weight}}\index{Reports ! Size-at-age}

Prints a summary of the size-at-age and size-weight relationship used by \SPM\ for each category. For each age between min age and max age, prints the mean size, as well as the size at user-defined quantiles. For user-defined lengths, returns the corresponding mean weights. Useful for verifying that the choice of parameters (and their magnitude) are sensible choices.

\TODOend