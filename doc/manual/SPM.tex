\documentclass[11pt,twoside,pdftex]{article}

% Misc packages
\usepackage{float}
\usepackage{setspace} % for defining spacing between lines
\usepackage{lastpage} % for getting numner of pages in document, \pageref{LastPage}

% Allow colour for HTML links
\usepackage{color}
\definecolor{darkgray}{gray}{0.20}

% Geometery for A4 layout like MS-Word defaults
\usepackage[left=2.54cm,top=2.54cm,bottom=3.17cm,right=3.17cm]{geometry}

% Natlib to better cite references (round brackets, commas between refs, and sorted)
\usepackage[round,comma,sort]{natbib}

% hyperref for HTML links within pdf 
\usepackage{hyperref}  %EXAMPLE: \href{http://www.niwa.co.nz}{NIWA}
\hypersetup{
  breaklinks=true,      % allow line breaks in URLs
  colorlinks=true,      % use colour to define links
  linkcolor=black,      % colour of internal links
  citecolor=black,      % colour of links to bibliography
  filecolor=black,      % colour of file links
  urlcolor=darkgray     % colour of external links
}

% Automatic index
\usepackage{makeidx}
\makeindex

% Graphics (no postscript files.. just use jpeg, png, etc)
\usepackage[dvips]{graphicx}
\usepackage{pslatex}

% Section header fonts
\usepackage{sectsty}
\allsectionsfont{\sffamily\normalsize} % Normal sized arial style section headings
\makeatletter % this bit adds a 'dot' after the section head numbers
\def\@seccntformat#1{\csname the#1\endcsname.\quad}
\makeatother

% Page style
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\headheight 25pt
\renewcommand{\headrulewidth}{0pt} % rule line under header
\renewcommand{\footrulewidth}{0pt}
\setlength{\parindent}{0pt} % No indentation at start of paragraph
\setlength{\baselineskip}{1ex plus 0.2ex minus 0.1ex}
\setlength{\parskip}{\medskipamount} % Gap between paragraphs
\raggedbottom % prefer space at the bottom of page

%% stop figures from going onto a page by themselves 
\renewcommand{\topfraction}{0.85}
\renewcommand{\textfraction}{0.1}
\renewcommand{\floatpagefraction}{0.75}

%% make list gaps small
\newcommand{\denselist}{\itemsep 0pt\topsep-0.5ex\partopsep-0.5ex}

% Verbatim enviroment for including external text files (e.g., program code)
\usepackage{fancyvrb}

% New commands to define macros and other aids to text and layout
\newcommand{\config}{input configuration file}
\newcommand{\command}[1] {\texttt{@#1}}
\newcommand{\subcommand}[1] {\texttt{#1}}
\newcommand{\commandsub}[2] {\command{#1}\subcommand{#2}}
\newcommand{\argument}[1] {\texttt{#1}}

\newcommand{\commentline}{\#}
\newcommand{\commentstart}{\{}
\newcommand{\commentend}{\}}

\newcommand{\Rzero}{\emph{R}$_0$}
\newcommand{\Bzero}{\emph{B}$_0$}
\newcommand{\R}{\textbf{R}}

% New commands to template syntax definitions
% Define a command without a label
\newcommand{\defCom}[2]{
 \begin{tabular}{l l}
  \texttt{\textbf{@#1}}\ & {#2}
 \end{tabular}
}
% Define a command with a label
\newcommand{\defComLab}[2]{
 \begin{tabular}{l l}
  \texttt{\textbf{@#1}\ \emph{label}} & {#2}
 \end{tabular}
}
% Define a command with an argument
\newcommand{\defComArg}[3]{
 \begin{tabular}{l l}
  \texttt{\textbf{@#1}\ #2} & {#3}
 \end{tabular}
}
% Define a Command argument
\newcommand{\defArg}[2]{
 \begin{tabular}{l l}
  \texttt{#1}\ & #2
 \end{tabular} \\*
}
% Define a subcommand
\newcommand{\defSub}[2]{
 \begin{tabular}{l l}
  \texttt{#1}\ & #2
 \end{tabular} \\*
}
% Define subcommand types, confditions, etc.
\newcommand{\defType}[1]{\hspace*{0.5cm}Type: {#1} \\*}
\newcommand{\defDefault}[1]{\hspace*{0.5cm}Default: {#1} \\*}
\newcommand{\defCondition}[1]{\hspace*{0.5cm}Conditions: {#1} \\*}
\newcommand{\defValue}[1]{\hspace*{0.5cm}Effect: {#1} \\*}
\newcommand{\defNote}[1]{\hspace*{0.5cm}Note: {#1} \\*}
\newcommand{\defExample}[1]{\hspace*{0.5cm}Example: {#1} \\*}

% Input SVN version definitions
\input{version.tex}
\newcommand{\DocYear}{\SourceControlYearDoc}
\newcommand{\DocMonth}{\SourceControlMonthDoc}
\newcommand{\DocDate}{\SourceControlMonthDoc\ \SourceControlYearDoc}
\newcommand{\DocVer}{\SourceControlDateDoc}

%New commands to automate document dates, manual titles, document reference, etc.
\newcommand{\VER}{\begin{small}\input{SPMversion.tex}\end{small}} % SPM program version
\newcommand{\SPM}{\texttt{SPM}} % SPM short  name
\newcommand{\SPMName}{Spatial Population Model} %SPM long name
\newcommand{\authors}{\href{mailto:"Alistair Dunn"<a.dunn@niwa.co.nz>?subject=SPM:}{authors}} %hyper ref for email
\newcommand{\Organisation}{National Institute of Water \& Atmospheric Research Ltd.} %NIWA
\newcommand{\ManualRef}{Dunn, A.; Rasmussen, S. (\DocYear) \SPMName\ User Manual (\SPM\ \VER). \Organisation\ \emph{Unpublished report}. \pageref{LastPage} p.} % full document reference
\title{\SPMName\ User Manual \\(\SPM\ \VER)} %Document title
\author{Alistair Dunn, Scott Rasmussen}  %Document authors
\date{\DocDate} %Date of publication

%Begin the document
\begin{document}
\hbadness=10000 % to deal with underull hbox warnings

% Title page
\pagenumbering{alph} % alpha not used, but used to remove warnings when page 1 is defined below
\maketitle
\thispagestyle{empty} % no header/footer/page numbers
~\vfill
\begin{center}
\SPMName\ User Manual (modified: \DocVer) \\ for use with \SPM\ \VER.
\end{center}

% Citation page
\cleardoublepage{}
\fancyfoot[C]{\thepage}
\pagenumbering{roman}
~\vfill
\begin{center}
{Citation:\\ \ManualRef}
\end{center}

% Table of contents
\cleardoublepage{}
\begin{spacing}{0.6} % Reduce space between lines in contents list
\tableofcontents
\end{spacing}

% Document body
\cleardoublepage{}
\renewcommand{\headrulewidth}{0.2pt}
\fancyhead[LE]{\slshape \nouppercase \rightmark} % Section headings at top of page (header, even pages)
\fancyhead[RO]{\slshape \nouppercase \leftmark}  % Section headings at top of page (header, odd pages)
\pagenumbering{arabic} % Page numbers a arabic numerals
\include{Introduction}

\cleardoublepage{}
\include{RunningSPM}

\cleardoublepage{}
\include{GettingStarted}

\cleardoublepage{}
\include{Population}

\cleardoublepage{}
\include{Estimation}

\cleardoublepage{}
\include{Output}

\cleardoublepage{}
%\section{Command and subcommand syntax\label{sec:syntax}}
\sloppy % use sloppy paras
\input{syntax/GeneralSyntax}\label{sec:syntax}
\cleardoublepage{}
\input{syntax/PopulationSyntax}
\cleardoublepage{}
\input{syntax/EstimationSyntax}
\cleardoublepage{}
\input{syntax/OutputSyntax}

\cleardoublepage{}
\include{Examples}

\cleardoublepage{}
\include{PostProcessing}

%\cleardoublepage{}
%\include{ChangesEnhancements} % not required for first version

\cleardoublepage{}
\include{Troubleshooting}

\cleardoublepage{}
\include{Acknowledgments}

\cleardoublepage{}
\include{QuickReference}

\cleardoublepage{}
% Referencing
\bibliographystyle{plainnat}
\renewcommand{\bibsection}{%
  \section{References}}
  \setcitestyle{round,aysep={},yysep={;}%
}

\include{References}

\cleardoublepage{}
\include{License}

\cleardoublepage{}

\let\stdsection\section % Force index to be a numbered section
\def\section*#1{\stdsection{#1}}
\printindex % Insert index
\let\section\stdsection

\end{document}
%End
